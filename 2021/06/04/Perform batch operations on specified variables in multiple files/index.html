<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	
	<!-- title -->
	
	<title>
	
		Perform batch operations on specified variables in multiple files | 
	 
	Omoikane Library
	</title>
	
	<!-- keywords,description -->
	
	

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/mokklo.top/favicon.ico">
	


	<!-- search -->
	<script>
		var searchEngine = "https://www.google.com/search?q=";
		if(typeof searchEngine == "undefined" || searchEngine == null || searchEngine == ""){
			searchEngine = "https://www.google.com/search?q=";
		}
		var homeHost = "";
		if(typeof homeHost == "undefined" || homeHost == null || homeHost == ""){
			homeHost = window.location.host;
		}
	</script>


	
<link rel="stylesheet" href="/mokklo.top/css/main.css">

	
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/darcula.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">


	
<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

	
<script src="/mokklo.top/js/main.js"></script>


	
		
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>

		
<script src="https://cdn.jsdelivr.net/npm/valine@v1.5.1/dist/Valine.min.js"></script>

	
	

<meta name="generator" content="Hexo 7.1.1"></head>

<body>
	<header id="header">
    <a id="title" href="/mokklo.top/" class="logo">Omoikane Library</a>

	<ul id="menu">
    

    
      <li class="menu-item">
        <a href="/tags" class="menu-item-link">Tags</a>
      </li>
    

    
      <li class="menu-item">
        <a href="/categories" class="menu-item-link">Categories</a>
      </li>
    

    
  
    
      <li class="menu-item">
        <a href='https://github.com/Mokklo' class="menu-item-link" target="_blank">
          <i class="fa fa-github fa-2x"></i>
        </a>
      </li>
    
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="search" placeholder="Press Enter to search">
		<div id="tree">
			

			
							<ul>
								<li class="file">
									<a href="/mokklo.top/2022/02/05/ArcGIS%E9%94%99%E8%AF%AF%E4%BB%A3%E7%A0%81-97%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/">
                     
										    ArcGIS错误代码-97解决方法
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/mokklo.top/2021/04/08/Create%20the%20personal%20blog%20based%20on%20Hexo/">
                     
										    Create the personal blog based on Hexo
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file active">
									<a href="/mokklo.top/2021/06/04/Perform%20batch%20operations%20on%20specified%20variables%20in%20multiple%20files/">
                     
										    Perform batch operations on specified variables in multiple files
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/mokklo.top/2023/02/09/%E5%9F%BA%E4%BA%8ERenpy%E7%9A%84live2D%E5%8F%8A%E5%A4%9A%E5%91%A8%E7%9B%AE%E5%AE%9E%E7%8E%B0/">
                     
										    基于Renpy的live2D及多周目实现
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/mokklo.top/2021/08/08/%E5%9F%BA%E4%BA%8Estata%E7%9A%84%E4%B8%BB%E6%88%90%E5%88%86%E5%88%86%E6%9E%90%E6%B3%95%EF%BC%88PCA%EF%BC%89%E5%AE%9E%E7%8E%B0/">
                     
										    基于stata的主成分分析法（PCA）实现
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
		</div>
	</div>
</div>

	<!-- 引入正文 -->
	<div id="content" class="content">
		<h1 id="article-title">
	Perform batch operations on specified variables in multiple files
</h1>

<!-- meta -->
<div class="article-meta">
	

	<span>Shixi</span>
	<span>2021-06-04 22:36:46</span>

  <div id="article-categories">
    
		  <span>Categories：</span>
      
          
              <span>
                  <i class="fa fa-folder" aria-hidden="true">
                  <a href="/categories/Python/">Python</a>
                  </i>
                
              </span>
          
      
    

    
		    <span>Tags：</span>
        
    
  </div>

</div>

<!-- content -->
<div id="article-content">
	<p>Recently, several interesting data processing issues have been discovered when I try to use wind speed as IV.</p>
<p>Meteorological data are mostly presented in the form of numerous <em>txt</em> files (like the following figure). Each <em>txt</em> files represents various meteorological values ​​of a weather station within a certain period of time. The simplest way to obtain the mean or quantile of specified variables in all weather stations is to open these txt files one by one and run the solution code. But when we have lots of files, it becomes difficult for us to traverse them manually.</p>
<center class='half'>
<img src="https://s2.loli.net/2022/12/01/cVNKljdzW6ShaYQ.png" width = "200" height = "200"  >
</center>

<p>Thus, I’ll show you how to achieve one-time calculations for a certain variable on multiple files with Python.</p>
<h2 id="Introduction-of-Data"><a href="#Introduction-of-Data" class="headerlink" title="Introduction of Data"></a>Introduction of Data</h2><h3 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1.Overview"></a>1.Overview</h3><p>This is more than three million pieces of ground meteorological data provided by 400 meteorological observation stations in China in 2017.</p>
<ul>
<li><p>Time range: Most are in three-hour units, and a few have one-hour data.</p>
</li>
<li><p>Meteorological parameters: temperature, air pressure, dew point, wind direction, wind speed, cloud cover and precipitation</p>
</li>
</ul>
<h3 id="2-Objective"><a href="#2-Objective" class="headerlink" title="2.Objective"></a>2.Objective</h3><p>Get the average wind speed of the all meteorological data.</p>
<h2 id="Data-Analysis"><a href="#Data-Analysis" class="headerlink" title="Data Analysis"></a>Data Analysis</h2><p>Take one meteorological data as an example, the ninth column is the wind speed we want to analysis. -9999 in each column represents missing values.</p>
<center class='half'>
<img src="https://i.loli.net/2021/06/04/JHLhZWsdEfvjl2D.jpg" width = "400" height = "400"  align=center />
</center>


<p>We can analysis it as a <em>csv</em> file:</p>
<pre><code>import os
import pandas as pd
import numpy as np

listx=[]
os.chdir(&#39;absolute path to data storage&#39;)
for filename in os.listdir(os.getcwd()): #read all files in a folder
    listxappend(filename)

for i in range(412):
    f=pd.read_csv(listx[i],delim_whitespace=True,header=None) #read files with whitespace as delimiter
    f=f.replace(-9999,0) #deal with missing value
    a1=f.iloc[:,8] 
    a2=np.mean(a1) 

print(a2)
</code></pre>
<p>Run the above codes, the results will be:</p>
<center class='half'>
<img src="https://i.loli.net/2021/06/04/RJ8ZfIkgKEuW2NO.jpg" width = "200" height = "450"  align=center />
</center>

<p>That means we have successfully calculate the average wind speed of the all meteorological data.</p>

</div>

<!-- post-guide -->

    <div class="post-guide">
        <div class="item left">
            
              <a href="/mokklo.top/2021/08/08/%E5%9F%BA%E4%BA%8Estata%E7%9A%84%E4%B8%BB%E6%88%90%E5%88%86%E5%88%86%E6%9E%90%E6%B3%95%EF%BC%88PCA%EF%BC%89%E5%AE%9E%E7%8E%B0/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  基于stata的主成分分析法（PCA）实现
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/mokklo.top/2021/04/08/Create%20the%20personal%20blog%20based%20on%20Hexo/">
                Create the personal blog based on Hexo
                <i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>


<!-- comment - giscus -->


<!-- comment - valine -->


<script>
	
	
</script>
	</div>
	<div id="footer">
	<p>
	©<span id="footerYear-start"></span>-<span id="footerYear-end"></span>

	
	    <a href="/">Shixi</a>
	
	
	
	<br>
	Theme <a href="//github.com/wujun234/hexo-theme-tree" target="_blank">Tree</a>
	by <a href="//wujun.me" target="_blank">Wu Jun</a>
	Powered by <a href="//hexo.io" target="_blank">Hexo</a>
	</p>
</div>


<script type="text/javascript">
	document.getElementById('footerYear-start').innerHTML = new Date().getFullYear() + '';
</script>

<script type="text/javascript">
	document.getElementById('footerYear-end').innerHTML = new Date().getFullYear() + '';
</script>

	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>